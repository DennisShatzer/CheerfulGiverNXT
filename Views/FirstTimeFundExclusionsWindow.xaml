<Window x:Class="CheerfulGiverNXT.FirstTimeFundExclusionsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="Admin: First-time Giver Fund Exclusions"
        Width="980"
        Height="680"
        MinWidth="820"
        MinHeight="560"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="{DynamicResource CG.Brush.WindowBackground}" Foreground="{DynamicResource CG.Brush.TextPrimary}">

    <Window.Resources>

        <sys:Double x:Key="Font.Base">16</sys:Double>
        <sys:Double x:Key="Input.Height">34</sys:Double>
        <Thickness x:Key="Input.Padding">10,6,10,6</Thickness>
        <CornerRadius x:Key="Corner.Button">6</CornerRadius>

        <Style x:Key="BodyText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="{StaticResource Font.Base}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>
        <Style TargetType="TextBlock" BasedOn="{StaticResource BodyText}"/>

        <Style x:Key="MutedText" TargetType="TextBlock" BasedOn="{StaticResource BodyText}">
            <Setter Property="Foreground" Value="{DynamicResource CG.Brush.TextMuted}"/>
        </Style>

        <ControlTemplate x:Key="ButtonTemplate.Rounded" TargetType="Button">
            <Border Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    CornerRadius="{StaticResource Corner.Button}">
                <ContentPresenter Margin="{TemplateBinding Padding}"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
            </Border>
        </ControlTemplate>

        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Template" Value="{StaticResource ButtonTemplate.Rounded}"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="FontSize" Value="{StaticResource Font.Base}"/>
            <Setter Property="Background" Value="{DynamicResource CG.Brush.Accent}"/>
            <Setter Property="Foreground" Value="{DynamicResource CG.Brush.AccentForeground}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource CG.Brush.Accent}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="{DynamicResource CG.Brush.SurfaceAlt}"/>
            <Setter Property="Foreground" Value="{DynamicResource CG.Brush.TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource CG.Brush.BorderStrong}"/>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="{DynamicResource CG.Brush.Danger}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource CG.Brush.Danger}"/>
        </Style>

        <Style x:Key="DataGridCellText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="{StaticResource Font.Base}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,10">
            <TextBlock FontSize="22" FontWeight="SemiBold" Text="First-time Giver Fund Exclusions"/>
            <TextBlock Style="{StaticResource MutedText}" Margin="0,4,0,0"
                       Text="These fund tokens are ignored when determining whether a donor is a first-time giver (per campaign)."/>
        </StackPanel>

        <!-- Campaign + status -->
        <DockPanel Grid.Row="1" Margin="0,0,0,10">
            <TextBlock DockPanel.Dock="Left" FontWeight="SemiBold" Text="{Binding CampaignLabel}"/>
            <TextBlock DockPanel.Dock="Right" Style="{StaticResource MutedText}" Text="{Binding StatusText}"/>
        </DockPanel>

        <!-- Grid -->
        <Border Grid.Row="2" Background="{DynamicResource CG.Brush.Surface}" BorderBrush="{DynamicResource CG.Brush.Border}" BorderThickness="1" CornerRadius="8">
            <DataGrid x:Name="ExclusionsGrid"
                      Background="{DynamicResource CG.Brush.Surface}"
                      Foreground="{DynamicResource CG.Brush.TextPrimary}"
                      BorderBrush="{DynamicResource CG.Brush.Border}"
                      ItemsSource="{Binding Rows}"
                      SelectedItem="{Binding SelectedRow, Mode=TwoWay}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      HeadersVisibility="Column"
                      RowHeaderWidth="0"
                      GridLinesVisibility="Horizontal"
                      SelectionMode="Single"
                      Margin="10">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Fund token" Binding="{Binding FundName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="3*"/>
                    <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive, Mode=TwoWay}" Width="*"/>
                    <DataGridTextColumn Header="Sort" Binding="{Binding SortOrder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="*"/>
                    <DataGridTextColumn Header="Created" Binding="{Binding CreatedAt, StringFormat={}{0:G}}" IsReadOnly="True" Width="2*"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- Buttons -->
        <DockPanel Grid.Row="3" Margin="0,12,0,0">
            <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                <Button x:Name="AddButton" Style="{StaticResource SecondaryButton}" Margin="0,0,10,0" Content="Add"/>
                <Button x:Name="RemoveButton" Style="{StaticResource DangerButton}" Margin="0,0,10,0"
                        Content="Remove" IsEnabled="{Binding CanRemove}"/>
            </StackPanel>

            <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="ReloadButton" Style="{StaticResource SecondaryButton}" Margin="0,0,10,0" Content="Reload"/>
                <Button x:Name="SaveButton" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0" Content="Save"/>
                <Button x:Name="CloseButton" Style="{StaticResource SecondaryButton}" Content="Close"/>
            </StackPanel>
        </DockPanel>

    </Grid>
</Window>
