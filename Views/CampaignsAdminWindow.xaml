<Window x:Class="CheerfulGiverNXT.CampaignsAdminWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="Admin: Campaigns"
        Width="1150"
        Height="720"
        MinWidth="920"
        MinHeight="560"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="{DynamicResource CG.Brush.WindowBackground}" Foreground="{DynamicResource CG.Brush.TextPrimary}">

    <Window.Resources>
        <sys:Double x:Key="Font.Base">16</sys:Double>
        <CornerRadius x:Key="Corner.Button">6</CornerRadius>

        <Style x:Key="BodyText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="{StaticResource Font.Base}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>
        <Style TargetType="TextBlock" BasedOn="{StaticResource BodyText}"/>

        <Style x:Key="MutedText" TargetType="TextBlock" BasedOn="{StaticResource BodyText}">
            <Setter Property="Foreground" Value="{DynamicResource CG.Brush.TextMuted}"/>
        </Style>

        <ControlTemplate x:Key="ButtonTemplate.Rounded" TargetType="Button">
            <Border Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    CornerRadius="{StaticResource Corner.Button}">
                <ContentPresenter Margin="{TemplateBinding Padding}"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
            </Border>
        </ControlTemplate>

        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Template" Value="{StaticResource ButtonTemplate.Rounded}"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="FontSize" Value="{StaticResource Font.Base}"/>
            <Setter Property="Background" Value="{DynamicResource CG.Brush.Accent}"/>
            <Setter Property="Foreground" Value="{DynamicResource CG.Brush.AccentForeground}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource CG.Brush.Accent}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="{DynamicResource CG.Brush.SurfaceAlt}"/>
            <Setter Property="Foreground" Value="{DynamicResource CG.Brush.TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource CG.Brush.BorderStrong}"/>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource PrimaryButton}">
            <Setter Property="Background" Value="{DynamicResource CG.Brush.Danger}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource CG.Brush.Danger}"/>
        </Style>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,10">
            <TextBlock FontSize="22" FontWeight="SemiBold" Text="Campaigns"/>
            <TextBlock Style="{StaticResource MutedText}" Margin="0,4,0,0"
                       Text="Edit campaign records used by Cheerful Giver. When you save, the system will enforce a single Active campaign."/>
        </StackPanel>

        <!-- Status -->
        <DockPanel Grid.Row="1" Margin="0,0,0,10">
            <TextBlock DockPanel.Dock="Left" FontWeight="SemiBold" Text="Ctrl+F12"/>
            <TextBlock DockPanel.Dock="Right" Style="{StaticResource MutedText}" Text="{Binding StatusText}"/>
        </DockPanel>

        <!-- Grid -->
        <Border Grid.Row="2" Background="{DynamicResource CG.Brush.Surface}" BorderBrush="{DynamicResource CG.Brush.Border}" BorderThickness="1" CornerRadius="8">
            <DataGrid x:Name="CampaignsGrid"
                      Background="{DynamicResource CG.Brush.Surface}"
                      Foreground="{DynamicResource CG.Brush.TextPrimary}"
                      BorderBrush="{DynamicResource CG.Brush.Border}"
                      ItemsSource="{Binding Rows}"
                      SelectedItem="{Binding SelectedRow, Mode=TwoWay}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      HeadersVisibility="Column"
                      RowHeaderWidth="0"
                      GridLinesVisibility="Horizontal"
                      SelectionMode="Single"
                      Margin="10">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding CampaignRecordId}" IsReadOnly="True" Width="80"/>
                    <DataGridTextColumn Header="Name" Binding="{Binding CampaignName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="2*"/>
                    <DataGridTextColumn Header="Start (Local)" Binding="{Binding StartLocal, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:G}}" Width="1.3*"/>
                    <DataGridTextColumn Header="End (Exclusive)" Binding="{Binding EndLocalExclusive, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:G}}" Width="1.3*"/>
                    <DataGridTextColumn Header="TimeZoneId" Binding="{Binding TimeZoneId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="1.2*"/>
                    <DataGridTextColumn Header="Goal $" Binding="{Binding GoalAmount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:0.00}}" Width="110"/>
                    <DataGridTextColumn Header="Goal FTG" Binding="{Binding GoalFirstTimeGivers, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="110"/>
                    <DataGridTextColumn Header="Fund List" Binding="{Binding FundList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="2*" MinWidth="220"/>
                    <DataGridTextColumn Header="Anon Giver ID" Binding="{Binding AnonymousGiverId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="130"/>
                    <DataGridTextColumn Header="Half-day $" Binding="{Binding SponsorshipHalfDayAmount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:0.00}}" Width="120"/>
                    <DataGridTextColumn Header="Full day $" Binding="{Binding SponsorshipFullDayAmount, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:0.00}}" Width="120"/>
                    <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive, Mode=TwoWay}" Width="90"/>
                    <DataGridTextColumn Header="Created" Binding="{Binding CreatedAt, StringFormat={}{0:G}}" IsReadOnly="True" Width="1.2*"/>
                    <DataGridTextColumn Header="Updated" Binding="{Binding UpdatedAt, StringFormat={}{0:G}}" IsReadOnly="True" Width="1.2*"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- Buttons -->
        <DockPanel Grid.Row="3" Margin="0,12,0,0">
            <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                <Button x:Name="AddButton" Style="{StaticResource SecondaryButton}" Margin="0,0,10,0" Content="Add"/>
                <Button x:Name="RemoveButton" Style="{StaticResource DangerButton}" Margin="0,0,10,0"
                        Content="Remove" IsEnabled="{Binding CanRemove}"/>
            </StackPanel>

            <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="ReloadButton" Style="{StaticResource SecondaryButton}" Margin="0,0,10,0" Content="Reload"/>
                <Button x:Name="SaveButton" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0" Content="Save"/>
                <Button x:Name="CloseButton" Style="{StaticResource SecondaryButton}" Content="Close"/>
            </StackPanel>
        </DockPanel>
    </Grid>
</Window>
