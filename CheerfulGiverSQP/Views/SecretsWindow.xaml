<Window x:Class="CheerfulGiverSQP.Views.SecretsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CheerfulGiverSQP = Server Secrets"
        Height="520" Width="820"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">

    <Grid Margin="14">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="Server Authorization &amp; Secrets" FontSize="18" FontWeight="SemiBold" />

        <Border Grid.Row="1" BorderBrush="#22000000" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,12,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="160" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Machine Key" FontWeight="SemiBold" VerticalAlignment="Center" />
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding MachineSecretKey, Mode=OneWay}" IsReadOnly="True" />

                <TextBlock Grid.Row="1" Grid.Column="0" Text="Client Id" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,8,0,0" />
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding ClientId, Mode=OneWay}" IsReadOnly="True" Margin="0,8,0,0" />

                <TextBlock Grid.Row="2" Grid.Column="0" Text="Redirect Uri" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,8,0,0" />
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding RedirectUri, Mode=OneWay}" IsReadOnly="True" Margin="0,8,0,0" />

                <TextBlock Grid.Row="3" Grid.Column="0" Text="Scope" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,8,0,0" />
                <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding Scope, Mode=OneWay}" IsReadOnly="True" Margin="0,8,0,0" />

                <Button Grid.Row="0" Grid.Column="2" Grid.RowSpan="2" Content="Authorize this server" Command="{Binding AuthorizeCommand}" Padding="14,10" Margin="10,0,0,0" VerticalAlignment="Top" />
                <Button Grid.Row="2" Grid.Column="2" Grid.RowSpan="2" Content="Reload status" Command="{Binding ReloadStatusCommand}" Padding="14,10" Margin="10,8,0,0" VerticalAlignment="Top" />
            </Grid>
        </Border>

        <Border Grid.Row="2" BorderBrush="#22000000" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="160" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="Subscription Key" FontWeight="SemiBold" VerticalAlignment="Center" />
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding SubscriptionKey, Mode=OneWay}" IsReadOnly="True" />
                <TextBlock Grid.Row="1" Grid.Column="0" Text="OAuth Client Secret" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,8,0,0" />
                <TextBlock Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Text="{Binding ClientSecretStatus, Mode=OneWay}" Margin="0,8,0,0" VerticalAlignment="Center" />
            </Grid>
        </Border>

        <GroupBox Grid.Row="3" Header="Current Token Status" Padding="10">
            <StackPanel>
                <TextBlock Text="{Binding TokenStatusLine}" TextWrapping="Wrap" />
                <TextBlock Text="{Binding LastError}" TextWrapping="Wrap" Opacity="0.8" Margin="0,6,0,0" />
            </StackPanel>
        </GroupBox>

        <DockPanel Grid.Row="4" Margin="0,12,0,0" LastChildFill="false">
            <TextBlock DockPanel.Dock="Left" Text="Note: tokens are stored per-machine (DPAPI LocalMachine). Authorize this server once." Opacity="0.7" VerticalAlignment="Center" />
            <Button DockPanel.Dock="Right" Content="Close" IsCancel="True" Padding="14,6" />
        </DockPanel>
    </Grid>
</Window>
